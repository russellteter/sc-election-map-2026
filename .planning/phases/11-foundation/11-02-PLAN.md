---
phase: 11-foundation
plan: 02
type: execute
depends_on: ["11-01"]
files_modified: [src/components/Landing/USMap.tsx, src/components/Landing/AnimatedUSMap.tsx]
domain: frontend
---

<objective>
Enhance USMap with animated zoom-to-state functionality using AnimatedMapContainer from Plan 01.

Purpose: Transform the static US map into an animated navigation interface where clicking a state triggers a smooth zoom before navigation.
Output: AnimatedUSMap component that zooms into selected state before routing, creating a polished "drill-down" experience.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-foundation/11-01-SUMMARY.md

**Source files:**
@src/components/Landing/USMap.tsx
@src/components/Map/AnimatedMapContainer.tsx (from Plan 01)

**Key patterns:**
- USMap uses inline STATE_PATHS with x,y coordinates for each state
- Navigation via router.push() on state click
- Existing hover effects: scale(1.02), drop-shadow
- isStateActive() determines clickable states

**Constraints:**
- Preserve existing functionality (inactive state modal, legends)
- Animation must complete before navigation (delay router.push)
- Mobile touch-friendly (no hover dependencies for core UX)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AnimatedUSMap wrapper component</name>
  <files>src/components/Landing/AnimatedUSMap.tsx</files>
  <action>
Create a new component that wraps USMap with AnimatedMapContainer for zoom animations.

**Component API:**
```tsx
interface AnimatedUSMapProps {
  onStateClick?: (stateCode: string) => void;
  onInactiveStateClick?: (state: AnyStateConfig) => void;
}
```

**Implementation:**
1. Import AnimatedMapContainer and USMap
2. Track selectedState and zoomLevel in local state
3. When state clicked:
   - Set zoomLevel to 2.5
   - Set zoomTarget to state's center coordinates (from STATE_PATHS)
   - After animation duration (400ms), call router.push()
4. Reset zoom after navigation completes

**Zoom target calculation:**
Convert STATE_PATHS x,y to normalized 0-1 coordinates:
```tsx
const normalizedX = statePath.x / 800; // viewBox width
const normalizedY = statePath.y / 500; // viewBox height
```

**Key behavior:**
- Only animate for active states
- Inactive states trigger modal immediately (no zoom)
- Use useReducedMotion to skip animation when preferred

**What to avoid:**
- Don't modify USMap.tsx internal logic in this task
- Don't block navigation for inactive states
  </action>
  <verify>TypeScript compiles; component renders USMap</verify>
  <done>AnimatedUSMap.tsx created with zoom-on-click behavior</done>
</task>

<task type="auto">
  <name>Task 2: Export STATE_PATHS and add helper for zoom targets</name>
  <files>src/components/Landing/USMap.tsx</files>
  <action>
Modify USMap to export STATE_PATHS constant and add a helper function for getting zoom targets.

**Changes:**
1. Export the STATE_PATHS constant (add `export` keyword)
2. Add helper function:

```tsx
export function getStateZoomTarget(stateCode: string): { x: number; y: number } | null {
  const path = STATE_PATHS[stateCode];
  if (!path) return null;
  return {
    x: path.x / 800,  // Normalize to 0-1
    y: path.y / 500,
  };
}
```

3. Add optional prop to USMap for external click handling:
```tsx
interface USMapProps {
  onStateClick?: (stateCode: string) => void;
  onInactiveStateClick?: (state: AnyStateConfig) => void;
  disableInternalNavigation?: boolean; // New prop - when true, don't call router.push internally
}
```

**What to avoid:**
- Don't change existing hover/click behavior
- Don't remove any existing functionality
- Don't change STATE_PATHS structure
  </action>
  <verify>npm run lint passes; USMap still works standalone</verify>
  <done>STATE_PATHS exported; getStateZoomTarget helper available; disableInternalNavigation prop added</done>
</task>

<task type="auto">
  <name>Task 3: Integrate AnimatedUSMap on landing page</name>
  <files>src/app/page.tsx</files>
  <action>
Replace USMap with AnimatedUSMap on the national landing page.

**Changes:**
1. Import AnimatedUSMap instead of USMap
2. Replace <USMap /> usage with <AnimatedUSMap />
3. Keep any existing onInactiveStateClick handler

**Verify:**
- Landing page renders without errors
- Clicking active state shows zoom animation
- Navigation occurs after animation completes

**What to avoid:**
- Don't change page layout or surrounding content
- Don't add new dependencies
  </action>
  <verify>npm run dev; landing page works; click SC shows zoom then navigates</verify>
  <done>Landing page uses AnimatedUSMap with zoom-to-state animation</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run lint` passes
- [ ] Landing page loads at localhost:3000
- [ ] Clicking SC (or any active state) shows zoom animation
- [ ] Navigation to state page occurs after animation
- [ ] Inactive states still show "coming soon" behavior
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Zoom-to-state animation is smooth and visually appealing
- Navigation timing feels natural (not too fast, not laggy)
- Existing USMap functionality preserved
</success_criteria>

<output>
After completion, create `.planning/phases/11-foundation/11-02-SUMMARY.md`:

---
phase: 11-foundation
plan: 02
subsystem: maps
tags: [animation, navigation, usmap]

requires:
  - phase: 11-foundation
    plan: 01
    provides: AnimatedMapContainer component
provides:
  - AnimatedUSMap component
  - Zoom-to-state navigation pattern
affects: [landing-page, navigation]

tech-stack:
  added: []
  patterns: [Delayed navigation after animation]

key-files:
  created:
    - src/components/Landing/AnimatedUSMap.tsx
  modified:
    - src/components/Landing/USMap.tsx
    - src/app/page.tsx

key-decisions: []
patterns-established:
  - Animation-then-navigate pattern for map drilling
issues-created: []
---

# Phase 11 Plan 02: Enhanced USMap Summary

**[One-liner about what shipped]**

## Accomplishments

- Created AnimatedUSMap with zoom-to-state animation
- Exported STATE_PATHS and getStateZoomTarget helper from USMap
- Integrated animated map on landing page

## Files Created/Modified

- `src/components/Landing/AnimatedUSMap.tsx` - Animated wrapper
- `src/components/Landing/USMap.tsx` - Added exports and prop
- `src/app/page.tsx` - Uses AnimatedUSMap

## Decisions Made

[Any decisions, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 11-03-PLAN.md (MiniMapPreview component)
</output>
