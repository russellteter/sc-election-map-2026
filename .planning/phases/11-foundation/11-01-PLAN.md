---
phase: 11-foundation
plan: 01
type: execute
depends_on: []
files_modified: [src/components/Map/AnimatedMapContainer.tsx, src/app/globals.css]
domain: frontend
---

<objective>
Create AnimatedMapContainer component with smooth CSS zoom transitions for SVG maps.

Purpose: Establish the animation foundation for v2.0's map-first navigation - smooth zoom transitions that feel natural when navigating between country, state, and district views.
Output: Reusable AnimatedMapContainer component with CSS-powered zoom/pan transitions, integrated into existing map architecture.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Codebase patterns to follow:**
- src/components/Map/DistrictMap.tsx (existing SVG map rendering, event delegation)
- src/app/globals.css (existing animation patterns: selection-burst keyframes, ease-out-expo)
- src/components/Landing/USMap.tsx (state-level hover/click handling)

**Design tokens available:**
- --ease-out-expo (Tailwind v4 timing function)
- --class-purple (#1E40AF) for focus/selection states
- drop-shadow patterns for depth effects

**Key constraints:**
- Zero new dependencies (CSS animations only)
- Must support prefers-reduced-motion
- Static export compatible (no server features)
- Mobile-first (touch interactions later in Phase 12+)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AnimatedMapContainer component</name>
  <files>src/components/Map/AnimatedMapContainer.tsx</files>
  <action>
Create a wrapper component that handles CSS-based zoom transitions for SVG maps.

**Component API:**
```tsx
interface AnimatedMapContainerProps {
  children: React.ReactNode;
  zoomLevel: number;        // 1 = full view, 2 = zoomed, etc.
  zoomTarget?: { x: number; y: number }; // Center point of zoom (0-1 normalized)
  transitionDuration?: number; // ms, default 400
  className?: string;
}
```

**Implementation:**
1. Use CSS transform: scale() and transform-origin for zoom
2. Wrap children in a div with overflow: hidden
3. Apply smooth transitions via CSS transition property
4. Calculate transform-origin from zoomTarget (default center)
5. Support zoomLevel from 1 (no zoom) to 3 (deep zoom)

**Critical patterns:**
- Use ref to measure container dimensions
- Apply transform: scale(zoomLevel) translate() for pan effect
- Respect prefers-reduced-motion via useReducedMotion hook pattern
- Use will-change: transform for GPU acceleration (only during animation)

**What to avoid:**
- Don't use JavaScript-based animation libraries (no GSAP, Framer Motion) - CSS only for v2.0 foundation
- Don't add pointer-events manipulation here (that's for Phase 12+)
  </action>
  <verify>Component renders without errors; TypeScript compiles without errors</verify>
  <done>AnimatedMapContainer.tsx exists with typed props, CSS transitions work for zoom changes</done>
</task>

<task type="auto">
  <name>Task 2: Add CSS animation tokens to globals.css</name>
  <files>src/app/globals.css</files>
  <action>
Add new CSS variables and keyframes for map zoom animations.

**Add to :root section (after existing tokens):**
```css
/* MAP ZOOM ANIMATION TOKENS */
--map-zoom-duration: 400ms;
--map-zoom-easing: cubic-bezier(0.16, 1, 0.3, 1); /* ease-out-expo */
--map-zoom-scale-max: 3;
```

**Add new keyframes (after existing selection-burst):**
```css
/* Map zoom transition class */
.map-zoom-container {
  transition: transform var(--map-zoom-duration) var(--map-zoom-easing);
  will-change: auto; /* Only set to transform during active animations */
}

.map-zoom-container.animating {
  will-change: transform;
}

/* Zoom levels for consistent scaling */
.map-zoom-1 { transform: scale(1); }
.map-zoom-2 { transform: scale(1.5); }
.map-zoom-3 { transform: scale(2.5); }

@media (prefers-reduced-motion: reduce) {
  .map-zoom-container {
    transition-duration: 0ms;
  }
}
```

**What to avoid:**
- Don't modify existing selection-burst animation
- Don't add Leaflet/MapLibre-related styles yet (Phase 12)
  </action>
  <verify>npm run lint passes; no CSS syntax errors</verify>
  <done>globals.css includes map zoom tokens and classes</done>
</task>

<task type="auto">
  <name>Task 3: Create useReducedMotion hook</name>
  <files>src/hooks/useReducedMotion.ts</files>
  <action>
Create a reusable hook for respecting prefers-reduced-motion preference.

**Implementation:**
```tsx
'use client';

import { useState, useEffect } from 'react';

export function useReducedMotion(): boolean {
  const [prefersReducedMotion, setPrefersReducedMotion] = useState(false);

  useEffect(() => {
    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
    setPrefersReducedMotion(mediaQuery.matches);

    const handler = (e: MediaQueryListEvent) => {
      setPrefersReducedMotion(e.matches);
    };

    mediaQuery.addEventListener('change', handler);
    return () => mediaQuery.removeEventListener('change', handler);
  }, []);

  return prefersReducedMotion;
}
```

**What to avoid:**
- Don't default to true (animations should work by default)
- Don't use deprecated addListener/removeListener API
  </action>
  <verify>TypeScript compiles; hook can be imported</verify>
  <done>useReducedMotion.ts exists in src/hooks/</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run lint` passes
- [ ] AnimatedMapContainer can be imported and rendered
- [ ] CSS zoom classes work (manually test .map-zoom-1, .map-zoom-2)
- [ ] useReducedMotion hook returns boolean
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript or ESLint errors
- AnimatedMapContainer ready for integration with USMap (Plan 02)
</success_criteria>

<output>
After completion, create `.planning/phases/11-foundation/11-01-SUMMARY.md`:

---
phase: 11-foundation
plan: 01
subsystem: maps
tags: [animation, css, zoom, accessibility]

requires: []
provides:
  - AnimatedMapContainer component
  - useReducedMotion hook
  - CSS zoom animation tokens
affects: [maps, navigation]

tech-stack:
  added: []
  patterns: [CSS transform animations, prefers-reduced-motion]

key-files:
  created:
    - src/components/Map/AnimatedMapContainer.tsx
    - src/hooks/useReducedMotion.ts
  modified:
    - src/app/globals.css

key-decisions: []
patterns-established:
  - CSS-only zoom animations via transform: scale()
  - useReducedMotion hook for accessibility
issues-created: []
---

# Phase 11 Plan 01: AnimatedMapContainer Summary

**[One-liner about what shipped]**

## Accomplishments

- Created AnimatedMapContainer with CSS zoom transitions
- Added map zoom animation tokens to design system
- Created useReducedMotion hook for accessibility

## Files Created/Modified

- `src/components/Map/AnimatedMapContainer.tsx` - Zoom container component
- `src/hooks/useReducedMotion.ts` - Motion preference hook
- `src/app/globals.css` - Animation tokens and classes

## Decisions Made

None

## Issues Encountered

[Any problems and resolutions, or "None"]

## Next Step

Ready for 11-02-PLAN.md (Enhanced USMap with zoomToState)
</output>
