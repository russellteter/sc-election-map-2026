---
phase: 05-county-contact-extraction
plan: 01
type: execute
depends_on: []
files_modified: [public/data/county-contacts.json, src/types/schema.ts, src/hooks/useVoterGuideData.ts, src/components/VoterGuide/CountyRaces.tsx]
---

<objective>
Extract hardcoded county election office URLs from CountyRaces.tsx to a JSON data file.

Purpose: Separate data from presentation, enabling easier updates to county contact information without code changes.
Output: New county-contacts.json with all 46 SC counties, updated component consuming from JSON.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context (Phase 4 decomposed voter guide):
@.planning/phases/04-voter-guide-decomposition/04-02-SUMMARY.md

# Key files to modify:
@src/components/VoterGuide/CountyRaces.tsx
@src/hooks/useVoterGuideData.ts
@src/types/schema.ts

# Reference for county names (all 46 counties in counties object):
@public/data/county-races.json

**Established patterns:**
- JSON data files go in public/data/
- Type definitions in src/types/schema.ts
- Data loading via useVoterGuideData hook with parallel fetch
- Components receive data via props, not direct imports

**Constraining decisions:**
- Phase 4: Extract hooks before components (data logic first)
- Data files use lastUpdated timestamp and source attribution
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create county-contacts.json with all 46 SC counties</name>
  <files>public/data/county-contacts.json</files>
  <action>
Create public/data/county-contacts.json with the following structure:
```json
{
  "lastUpdated": "[current ISO timestamp]",
  "source": "SC County Government Websites",
  "defaultUrl": "https://scvotes.gov/voters/locate-your-county-voter-registration-and-elections-office/",
  "counties": {
    "Abbeville": { "electionUrl": "...", "phone": null, "address": null },
    ...
  }
}
```

Requirements:
- Include ALL 46 SC counties from county-races.json
- For the 10 counties with known URLs (Greenville, Richland, Charleston, Horry, Spartanburg, Lexington, York, Berkeley, Anderson, Beaufort), use their existing URLs from CountyRaces.tsx
- For remaining 36 counties, set electionUrl to null (will fall back to defaultUrl)
- Include phone and address fields as null placeholders for future enrichment
- Add lastUpdated timestamp and source attribution

County URLs to migrate from CountyRaces.tsx:
- Greenville: https://www.greenvillecounty.org/voterregistration/
- Richland: https://richlandcountysc.gov/government/election-commission
- Charleston: https://www.charlestoncounty.org/departments/bevr/
- Horry: https://www.horrycounty.org/Departments/Voter-Registration
- Spartanburg: https://www.spartanburgcounty.org/189/Voter-Registration
- Lexington: https://lex-co.sc.gov/departments/election-commission
- York: https://www.yorkcountygov.com/137/Board-of-Voter-Registration-Elections
- Berkeley: https://www.berkeleycountysc.gov/election/
- Anderson: https://www.andersoncountysc.org/voter-registration/
- Beaufort: https://www.beaufortcountysc.gov/elections/
  </action>
  <verify>cat public/data/county-contacts.json | jq '.counties | keys | length' returns 46</verify>
  <done>county-contacts.json exists with all 46 SC counties, 10 with URLs, 36 with null</done>
</task>

<task type="auto">
  <name>Task 2: Add CountyContacts type and update data loading</name>
  <files>src/types/schema.ts, src/hooks/useVoterGuideData.ts</files>
  <action>
1. Add CountyContactsData interface to src/types/schema.ts:
```typescript
/**
 * County election office contact information
 */
export interface CountyContact {
  electionUrl: string | null;
  phone: string | null;
  address: string | null;
}

/**
 * County contacts data file structure
 */
export interface CountyContactsData {
  lastUpdated: string;
  source: string;
  defaultUrl: string;
  counties: Record<string, CountyContact>;
}
```

2. Update src/hooks/useVoterGuideData.ts:
- Import CountyContactsData type
- Add countyContacts to AllRacesData interface
- Add county-contacts.json fetch to Promise.all (10th file)
- Add countyContacts to setData call

Avoid: Don't remove any existing data loading - this is additive only.
  </action>
  <verify>npm run build completes without TypeScript errors</verify>
  <done>CountyContactsData type exists, useVoterGuideData loads county-contacts.json</done>
</task>

<task type="auto">
  <name>Task 3: Update CountyRaces to use JSON data</name>
  <files>src/components/VoterGuide/CountyRaces.tsx, src/app/voter-guide/page.tsx</files>
  <action>
1. Update CountyRaces component:
- Remove hardcoded COUNTY_ELECTION_URLS object (lines 11-23)
- Remove DEFAULT_COUNTY_URL constant (line 26)
- Add countyContacts prop to CountyRacesProps interface
- Import CountyContactsData type
- Update countyElectionUrl logic to use countyContacts data:
  ```typescript
  const countyElectionUrl = countyName && countyContacts?.counties[countyName]?.electionUrl
    ? countyContacts.counties[countyName].electionUrl
    : countyContacts?.defaultUrl || 'https://scvotes.gov/voters/locate-your-county-voter-registration-and-elections-office/';
  ```

2. Update voter-guide/page.tsx:
- Pass allData.countyContacts to CountyRaces component:
  ```tsx
  <CountyRaces
    data={allData.countyRaces}
    countyName={districtResult.countyName || null}
    countyContacts={allData.countyContacts}
  />
  ```

Avoid: Don't change the visual appearance or functionality - only the data source.
  </action>
  <verify>npm run dev, navigate to voter guide, enter address, verify county election link still works</verify>
  <done>CountyRaces loads URLs from JSON, hardcoded data removed, links still functional</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run lint` passes
- [ ] county-contacts.json has 46 counties
- [ ] Voter guide shows correct county election links for Greenville, Charleston, Richland
- [ ] Counties without URLs fall back to scvotes.gov default
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No hardcoded county URLs remain in CountyRaces.tsx
- county-contacts.json is the single source of truth for county election URLs
- Phase 5 complete
</success_criteria>

<output>
After completion, create `.planning/phases/05-county-contact-extraction/05-01-SUMMARY.md`:

# Phase 5 Plan 01: County Contact Extraction Summary

**[One-liner describing what shipped]**

## Accomplishments

- [Key outcomes]

## Files Created/Modified

- `public/data/county-contacts.json` - [description]
- `src/types/schema.ts` - [description]
- `src/hooks/useVoterGuideData.ts` - [description]
- `src/components/VoterGuide/CountyRaces.tsx` - [description]
- `src/app/voter-guide/page.tsx` - [description]

## Decisions Made

[Any decisions made during implementation]

## Issues Encountered

[Any issues and resolutions]

## Next Step

Phase 5 complete, ready for Phase 6: Address UX Improvements
</output>
