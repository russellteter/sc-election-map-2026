---
phase: 14-navigation-maps
plan: 04
type: execute
depends_on: ["14-01", "14-02"]
files_modified:
  - src/components/Landing/NavigableUSMap.tsx
  - src/app/page.tsx
domain: next-js
---

<objective>
Create NavigableUSMap component that transforms the landing page US map into a navigation-first interface with URL-synced state.

Purpose: Make the national map the primary way users discover and navigate to states, with deep-linking support for sharing specific views.

Output: NavigableUSMap component integrated with landing page, supporting zoom-to-state animation and URL state sync.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-foundation/11-02-SUMMARY.md
@.planning/phases/14-navigation-maps/14-02-PLAN.md

**Key Files:**
@src/components/Landing/AnimatedUSMap.tsx
@src/components/Landing/USMap.tsx
@src/app/page.tsx
@src/hooks/useMapState.ts (from Plan 02)

**Tech stack available:**
- AnimatedUSMap (zoom-to-state animation)
- useReducedMotion hook
- useMapState hook (from Plan 02)
- STATE_PATHS export for state coordinates

**Established patterns:**
- getStateZoomTarget for state-specific zoom coordinates
- AnimatedMapContainer for CSS zoom transitions
- isStateActive for active/inactive state handling

**Constraining decisions:**
- Phase 11: CSS-powered zoom (not Leaflet on landing)
- Keep landing page lightweight (no Leaflet dependency)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create NavigableUSMap component</name>
  <files>src/components/Landing/NavigableUSMap.tsx</files>
  <action>
Create NavigableUSMap that extends AnimatedUSMap with URL state sync:

1. Component signature:
   ```typescript
   interface NavigableUSMapProps {
     onStateClick?: (stateCode: string) => void;
     onInactiveStateClick?: (state: AnyStateConfig) => void;
     initialState?: string; // Highlight specific state on mount
     syncUrl?: boolean; // Enable URL state sync (default: true)
   }
   ```

2. URL state integration:
   - Use useMapState hook for URL sync
   - Support `?state=SC` parameter for initial highlight
   - Update URL when state is hovered (optional, with debounce)
   - Clear state param after navigation

3. Enhanced interaction:
   - Hover: Highlight state, optionally update URL
   - Single click: Zoom animation + navigate (existing)
   - Support keyboard navigation (Tab + Enter on states)

4. Deep-link support:
   - On mount, check URL for `?state=` param
   - If found, scroll map into view and highlight that state
   - Auto-zoom to highlighted state after brief delay

5. Accessibility:
   - Add aria-label to state paths
   - Support focus-visible for keyboard users
   - Announce state name on focus

Build on top of AnimatedUSMap - extend, don't replace.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>NavigableUSMap.tsx created with URL sync, keyboard navigation, deep-linking</done>
</task>

<task type="auto">
  <name>Task 2: Integrate NavigableUSMap with landing page</name>
  <files>src/app/page.tsx</files>
  <action>
Replace AnimatedUSMap with NavigableUSMap on the landing page:

1. Update import:
   ```tsx
   import NavigableUSMap from '@/components/Landing/NavigableUSMap';
   ```

2. Replace AnimatedUSMap usage:
   - Pass onInactiveStateClick for "Coming Soon" modal
   - Enable URL sync (default)

3. Handle URL state on mount:
   - If `?state=` in URL, pass as initialState prop
   - Scroll to map section if state specified

4. Update page metadata:
   - Ensure OG tags work with state parameter
   - Add canonical URL handling

5. Test deep-link flow:
   - Visit `/?state=SC`
   - SC should be highlighted
   - Clicking navigates to /sc

Avoid: Adding Leaflet to landing page (keep it CSS-only for performance).
Why: Landing page must load fast; Leaflet is ~18KB overhead.
  </action>
  <verify>
Run dev server: `npm run dev`
Test flows:
1. Visit / - map renders, states clickable
2. Visit /?state=SC - SC highlighted on mount
3. Click SC - zoom animation, navigates to /sc
4. Tab through map - states focusable
  </verify>
  <done>Landing page uses NavigableUSMap with deep-linking support</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>NavigableUSMap with URL sync and deep-linking on landing page</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000
    3. Default view: All states visible, active states (SC, NC, GA, FL, VA) clickable
    4. Deep-link test: Visit http://localhost:3000/?state=SC
       - SC should be highlighted/focused on load
    5. Navigation test: Click SC
       - Zoom animation plays
       - Navigates to /sc
    6. Keyboard test: Tab to focus states, Enter to select
    7. Inactive state: Click an inactive state
       - "Coming Soon" modal should appear
    8. Mobile test (375px viewport): Touch interactions work
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Deep-link `/?state=SC` highlights South Carolina
- [ ] Click-to-navigate works with zoom animation
- [ ] Keyboard navigation (Tab + Enter) works
- [ ] No Leaflet loaded on landing page (check Network tab)
- [ ] Inactive states show "Coming Soon" modal
- [ ] Mobile touch works correctly
</verification>

<success_criteria>
- NavigableUSMap component created
- Landing page integrates NavigableUSMap
- Deep-linking works (`/?state=SC`)
- Keyboard navigation accessible
- No performance regression (no Leaflet on landing)
- Phase 14 complete
</success_criteria>

<output>
After completion, create `.planning/phases/14-navigation-maps/14-04-SUMMARY.md` following the summary template.

Include "Phase 14 complete, v2.0 Map Navigation System milestone ready for verification."
</output>
