---
phase: 14-navigation-maps
plan: 03
type: execute
depends_on: ["14-02"]
files_modified:
  - src/components/Map/ZoomLevelContent.tsx
  - src/app/[state]/page.tsx
domain: next-js
---

<objective>
Create ZoomLevelContent component for progressive disclosure based on map zoom level.

Purpose: Show different UI content based on how zoomed in the map is - overview KPIs at state level, district details when zoomed to a district.

Output: ZoomLevelContent component integrated with state dashboard, showing contextual content based on zoom.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-navigation-maps/14-02-PLAN.md

**Key Files:**
@src/app/[state]/page.tsx
@src/hooks/useMapState.ts (from Plan 02)

**Tech stack available:**
- useMapState hook (from Plan 02)
- Leaflet zoom events
- React state management

**Established patterns:**
- KPI cards in state dashboard
- SidePanel for district details
- Glassmorphic design system

**Constraining decisions:**
- Phase 12: Hybrid SVG/Leaflet approach
- Phase 13: Chamber toggle pattern
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ZoomLevelContent component</name>
  <files>src/components/Map/ZoomLevelContent.tsx</files>
  <action>
Create ZoomLevelContent for progressive disclosure:

1. Component signature:
   ```typescript
   interface ZoomLevelContentProps {
     currentZoom: number;
     stateViewContent: React.ReactNode;
     regionViewContent?: React.ReactNode;
     districtViewContent?: React.ReactNode;
     transitionDuration?: number; // ms, default 300
     className?: string;
   }
   ```

2. Define zoom thresholds:
   - State view: zoom <= 8 (shows overview)
   - Region view: 8 < zoom <= 10 (shows regional context)
   - District view: zoom > 10 (shows district details)

3. Render logic:
   - Show stateViewContent at state zoom
   - Show regionViewContent at region zoom (fallback to stateViewContent if not provided)
   - Show districtViewContent at district zoom (fallback to regionViewContent)

4. Transitions:
   - Fade in/out between content levels
   - Use CSS transitions for smooth changes
   - Respect prefers-reduced-motion

5. Styling:
   - Container with relative positioning
   - Absolute positioned children for smooth transitions
   - Glassmorphic background matching design system

Export named and default exports.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>ZoomLevelContent.tsx created with zoom thresholds and smooth transitions</done>
</task>

<task type="auto">
  <name>Task 2: Integrate with state dashboard</name>
  <files>src/app/[state]/page.tsx</files>
  <action>
Integrate ZoomLevelContent with the state dashboard:

1. Import components and hooks:
   ```tsx
   import ZoomLevelContent from '@/components/Map/ZoomLevelContent';
   import { useMapState } from '@/hooks/useMapState';
   ```

2. Add zoom state tracking:
   - Use useMapState hook to get current zoom level
   - Update zoom when map changes (via updateFromMap callback)

3. Replace static KPI cards with ZoomLevelContent:
   - State view (zoom <= 8): Show current KPI cards
   - Region view (8 < zoom <= 10): Show simplified 2-column KPI
   - District view (zoom > 10): Show selected district mini-summary

4. Wire up zoom change events:
   - When using Leaflet mode, listen to 'zoomend' event
   - Update mapState on zoom change
   - Debounce to prevent thrashing

5. Preserve existing functionality:
   - KPIs still show at state level
   - SidePanel still works for selected district
   - Filters still work

Avoid: Breaking mobile layout or touch interactions.
Why: Mobile users are primary audience.
  </action>
  <verify>
Run dev server: `npm run dev`
Navigate to /sc and test:
1. At default zoom, KPI cards visible
2. Zoom in (scroll or pinch), content transitions
3. At high zoom, district-specific content shows
4. Zoom out returns to KPI view
  </verify>
  <done>State dashboard shows contextual content based on zoom level</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>ZoomLevelContent with progressive disclosure based on zoom</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000/sc
    3. At default zoom (state view): Verify KPI cards are visible
    4. Zoom in using scroll wheel or pinch
    5. At region zoom (8-10): Verify content transitions
    6. At district zoom (>10): Verify district-specific content shows
    7. Zoom out: Verify smooth transition back to KPI view
    8. Test on mobile viewport (375px width): Verify touch zoom works
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] ZoomLevelContent renders appropriate content at each zoom level
- [ ] Transitions are smooth and respect reduced motion
- [ ] Mobile touch zoom triggers content changes
- [ ] No regressions to existing KPI or filter functionality
</verification>

<success_criteria>
- ZoomLevelContent component created and working
- State dashboard shows contextual content based on zoom
- Smooth transitions between zoom levels
- Mobile-friendly with touch support
</success_criteria>

<output>
After completion, create `.planning/phases/14-navigation-maps/14-03-SUMMARY.md` following the summary template.
</output>
