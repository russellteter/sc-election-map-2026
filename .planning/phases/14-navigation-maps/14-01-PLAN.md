---
phase: 14-navigation-maps
plan: 01
type: execute
depends_on: []
files_modified:
  - src/components/Map/NavigableDistrictMap.tsx
  - src/app/[state]/page.tsx
domain: next-js
---

<objective>
Create NavigableDistrictMap component that enables click-to-navigate on district maps.

Purpose: Transform district maps from passive display into primary navigation interface - clicking a district navigates to that district's detail view.

Output: NavigableDistrictMap component integrated with state dashboard, supporting both House and Senate chambers.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-leaflet-integration/12-SUMMARY.md
@.planning/phases/13-voter-guide-map/13-SUMMARY.md

**Key Files:**
@src/components/Map/HybridMapContainer.tsx
@src/components/Map/DistrictGeoJSONLayer.tsx
@src/components/Map/DistrictMap.tsx
@src/app/[state]/page.tsx

**Tech stack available:**
- Leaflet + react-leaflet (from Phase 12)
- HybridMapContainer (SVG/Leaflet hybrid)
- DistrictGeoJSONLayer (styled GeoJSON overlays)
- AnimatedMapContainer (CSS zoom transitions)

**Established patterns:**
- Dynamic Leaflet imports for zero bundle impact
- useRouter for navigation
- Chamber toggle pattern (House/Senate/Congressional)
- District click handlers via onDistrictClick callback

**Constraining decisions:**
- Phase 12: Hybrid SVG/Leaflet approach (SVG default, Leaflet on interaction)
- Phase 13: Chamber toggle instead of stacked maps (better mobile UX)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create NavigableDistrictMap component</name>
  <files>src/components/Map/NavigableDistrictMap.tsx</files>
  <action>
Create NavigableDistrictMap that wraps HybridMapContainer with navigation behavior:

1. Accept props:
   - stateCode: string
   - chamber: 'house' | 'senate' | 'congressional'
   - candidatesData, electionsData (for coloring)
   - selectedDistrict, onDistrictSelect (for highlighting)
   - enableNavigation?: boolean (default true)
   - onNavigate?: (districtNumber: number) => void (optional callback)

2. Navigation behavior:
   - Single click: Select district (existing behavior)
   - Double-click: Navigate to district detail page
   - Use Next.js useRouter for navigation
   - Route format: `/{state}?chamber={chamber}&district={number}`

3. Visual feedback:
   - Cursor: 'pointer' on districts
   - Add subtle hover tooltip "Double-click to view details"
   - Respect prefers-reduced-motion for any animations

4. Reuse HybridMapContainer internally - don't duplicate code.

5. Export both default and named export for flexibility.

Avoid: Creating a completely new map component - wrap and extend HybridMapContainer.
Why: Code reuse, consistent behavior, maintainable codebase.
  </action>
  <verify>TypeScript compiles without errors: `npx tsc --noEmit`</verify>
  <done>NavigableDistrictMap.tsx exists with double-click navigation, proper TypeScript types</done>
</task>

<task type="auto">
  <name>Task 2: Integrate NavigableDistrictMap in state dashboard</name>
  <files>src/app/[state]/page.tsx</files>
  <action>
Replace DistrictMap with NavigableDistrictMap in the state dashboard:

1. Import NavigableDistrictMap:
   ```tsx
   import NavigableDistrictMap from '@/components/Map/NavigableDistrictMap';
   ```

2. Replace the DistrictMap usage in the map-container div:
   - Pass stateCode from useStateContext
   - Pass chamber state
   - Pass candidatesData, electionsData
   - Pass selectedDistrict, onDistrictClick handlers
   - enableNavigation={true}

3. Update the keyboard shortcuts (j/k for next/prev) to work with NavigableDistrictMap.

4. Ensure URL state sync continues working (already handled by existing updateUrl effect).

Avoid: Breaking existing filter functionality or keyboard shortcuts.
Why: This is an enhancement, not a replacement of existing features.
  </action>
  <verify>
Run dev server: `npm run dev`
Navigate to /sc, verify:
1. Map renders correctly
2. Single-click selects district (side panel updates)
3. Double-click opens district in URL params
4. Filters still work
  </verify>
  <done>State dashboard uses NavigableDistrictMap, double-click navigates to district detail view</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npx tsc --noEmit` passes
- [ ] NavigableDistrictMap renders in state dashboard
- [ ] Single-click selects district
- [ ] Double-click updates URL with district parameter
- [ ] Chamber toggle works correctly
- [ ] Existing filters and keyboard shortcuts work
</verification>

<success_criteria>
- NavigableDistrictMap component created and exported
- State dashboard integrates NavigableDistrictMap
- Double-click navigation works for both House and Senate
- No regressions to existing functionality
</success_criteria>

<output>
After completion, create `.planning/phases/14-navigation-maps/14-01-SUMMARY.md` following the summary template.
</output>
