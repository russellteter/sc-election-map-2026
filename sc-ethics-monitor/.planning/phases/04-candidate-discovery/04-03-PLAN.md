---
phase: 04-candidate-discovery
plan: 03
type: standard
---

# Plan 04-03: Party Sources (SCDP/SCGOP)

<objective>
Implement party-specific candidate discovery sources for the SC Democratic Party and SC Republican Party websites.

Purpose: Party websites provide authoritative party affiliation data and may list candidates not yet on Ballotpedia.

Output: Working SCDPSource and SCGOPSource classes that discover party-endorsed candidates.
</objective>

<context>
@.planning/phases/04-candidate-discovery/DESIGN.md
@src/candidate_discovery/sources/base.py
@src/candidate_discovery/sources/ballotpedia.py
@src/candidate_discovery/rate_limiter.py
</context>

<tasks>

<task type="auto" id="1">
  <name>Implement SCDPSource class</name>
  <action>
    Create `src/candidate_discovery/sources/scdp.py` with:
    - SCDPSource(CandidateSource) class
    - source_name = "scdp"
    - source_priority = 3
    - BASE_URL = "https://www.scdp.org/candidates" (or similar)
    - All discovered candidates have party = "D"
    - Uses Firecrawl for scraping
    - _parse_candidate_list() to extract candidate info
  </action>
  <verify>Class instantiates without error</verify>
  <done>SCDPSource class is defined with proper structure</done>
</task>

<task type="auto" id="2">
  <name>Implement SCDP candidate parsing</name>
  <action>
    Add to SCDPSource:
    - _parse_candidates(markdown) method
    - Extracts candidate names and district assignments
    - Handles various page layouts (list, cards, tables)
    - Detects "House District X" or "Senate District Y" patterns
    - Creates DiscoveredCandidate with party="D", party_confidence="HIGH"
  </action>
  <verify>Parsing extracts candidates from sample SCDP page content</verify>
  <done>SCDP parsing handles typical party website formats</done>
</task>

<task type="auto" id="3">
  <name>Implement SCDP discovery method</name>
  <action>
    Add to SCDPSource:
    - async discover_candidates(chambers=["house", "senate"]) method
    - Scrapes main candidate listing page
    - May need to follow pagination or filter links
    - Returns list of DiscoveredCandidate objects
    - Handles case where page is unavailable or empty
  </action>
  <verify>Method runs without error and returns candidates</verify>
  <done>SCDP discovery finds Democratic candidates</done>
</task>

<task type="auto" id="4">
  <name>Implement SCGOPSource class</name>
  <action>
    Create `src/candidate_discovery/sources/scgop.py` with:
    - SCGOPSource(CandidateSource) class
    - source_name = "scgop"
    - source_priority = 3
    - BASE_URL = "https://www.scgop.com/candidates" (or similar)
    - All discovered candidates have party = "R"
    - Similar structure to SCDPSource
  </action>
  <verify>Class instantiates without error</verify>
  <done>SCGOPSource class is defined with proper structure</done>
</task>

<task type="auto" id="5">
  <name>Implement SCGOP candidate parsing</name>
  <action>
    Add to SCGOPSource:
    - _parse_candidates(markdown) method
    - Similar parsing logic to SCDP but adapted for GOP site format
    - Creates DiscoveredCandidate with party="R", party_confidence="HIGH"
    - Handles GOP-specific page layouts
  </action>
  <verify>Parsing extracts candidates from sample SCGOP page content</verify>
  <done>SCGOP parsing handles Republican party website format</done>
</task>

<task type="auto" id="6">
  <name>Implement SCGOP discovery method</name>
  <action>
    Add to SCGOPSource:
    - async discover_candidates(chambers=["house", "senate"]) method
    - Scrapes main candidate listing page
    - Returns list of DiscoveredCandidate objects
    - Handles pagination if present
  </action>
  <verify>Method runs without error and returns candidates</verify>
  <done>SCGOP discovery finds Republican candidates</done>
</task>

<task type="auto" id="7">
  <name>Add extract_district_candidates to both sources</name>
  <action>
    Add to both SCDPSource and SCGOPSource:
    - extract_district_candidates(district_id) method
    - Filters discovered candidates by district
    - Returns candidates matching the specified district
  </action>
  <verify>Can filter candidates for specific districts</verify>
  <done>District filtering works for both sources</done>
</task>

<task type="auto" id="8">
  <name>Create unit tests for party sources</name>
  <action>
    Create `tests/test_party_sources.py` with tests for:
    - SCDP URL and page parsing
    - SCGOP URL and page parsing
    - Party assignment (D for SCDP, R for SCGOP)
    - District extraction from text
    - Error handling for unavailable pages
    - Empty candidate list handling
  </action>
  <verify>pytest tests/test_party_sources.py -v</verify>
  <done>All party source tests pass</done>
</task>

</tasks>

<verification>
- [ ] SCDPSource implements CandidateSource interface
- [ ] SCGOPSource implements CandidateSource interface
- [ ] Both sources correctly assign party affiliation
- [ ] District extraction works for House and Senate
- [ ] Error handling for unavailable party websites
- [ ] All unit tests pass
</verification>

<success_criteria>
- Both party sources can discover candidates from their websites
- Party affiliation is HIGH confidence for party-sourced candidates
- Sources handle various page formats gracefully
- Test coverage for parsing and error scenarios
</success_criteria>

<output>
Create 04-03-SUMMARY.md documenting:
- SCDPSource and SCGOPSource implementations
- Page formats discovered on party websites
- Any challenges with party website scraping
- Test coverage summary
</output>
